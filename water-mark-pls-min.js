!function(e,t){"function"==typeof define&&define.amd?define([],t()):"object"==typeof module&&module.exports?module.exports=t():e.watermark=t()}(this,function(){var r,e={},t=!1,b={watermark_id:"wm_div_id",watermark_prefix:"mask_div_id",watermark_txt:"测试水印",watermark_x:20,watermark_y:20,watermark_rows:0,watermark_cols:0,watermark_x_space:50,watermark_y_space:50,watermark_font:"微软雅黑",watermark_color:"black",watermark_color_size:0,watermark_fontsize:"18px",watermark_alpha:.15,watermark_width:100,watermark_height:100,watermark_angle:15,watermark_scale:1,watermark_angle_random:!1,watermark_scale_random:!1,watermark_parent_width:0,watermark_parent_height:0,watermark_parent_node:null,monitor:!0},a=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,M=void 0!==a,z=M?new a(function(e){t?t=!1:(r&&1===e.length||1===e.length&&1<=e[0].removedNodes.length)&&o(r)}):null,E={childList:!0,attributes:!0,subtree:!0},o=function(e){if(1===arguments.length&&"object"==typeof e){var t,r=e||{};for(t in r)r[t]&&b[t]&&r[t]===b[t]||!r[t]&&0!==r[t]||(b[t]=r[t])}for(var a,o,m=document.getElementById(b.watermark_id),n=(m&&m.parentNode&&m.parentNode.removeChild(m),document.getElementById(b.watermark_parent_node)),m=n||document.body,w=Math.max(m.scrollWidth,m.clientWidth),i=Math.max(m.scrollHeight,m.clientHeight),_=e||{},s=m,d=0,l=0,_=(_.watermark_parent_width||_.watermark_parent_height?s&&(d=s.offsetTop||0,b.watermark_x=b.watermark_x+(l=s.offsetLeft||0),b.watermark_y=b.watermark_y+d):s&&(d=s.offsetTop||0,l=s.offsetLeft||0),document.getElementById(b.watermark_id)),k=null,s=(_?_.shadowRoot&&(k=_.shadowRoot):((_=document.createElement("div")).id=b.watermark_id,_.setAttribute("style","pointer-events: none !important; display: block !important"),k="function"==typeof _.attachShadow?_.attachShadow({mode:"open"}):_,(s=m.children)[h=Math.floor(Math.random()*(s.length-1))]?m.insertBefore(_,s[h]):m.appendChild(_)),b.watermark_cols=parseInt((w-b.watermark_x)/(b.watermark_width+b.watermark_x_space)),parseInt((w-b.watermark_x-b.watermark_width*b.watermark_cols)/b.watermark_cols)),h=(b.watermark_x_space=s&&b.watermark_x_space,b.watermark_rows=parseInt((i-b.watermark_y)/(b.watermark_height+b.watermark_y_space)),parseInt((i-b.watermark_y-b.watermark_height*b.watermark_rows)/b.watermark_rows)),c=(b.watermark_y_space=h&&b.watermark_y_space,o=n?(a=b.watermark_x+b.watermark_width*b.watermark_cols+b.watermark_x_space*(b.watermark_cols-1),b.watermark_y+b.watermark_height*b.watermark_rows+b.watermark_y_space*(b.watermark_rows-1)):(a=l+b.watermark_x+b.watermark_width*b.watermark_cols+b.watermark_x_space*(b.watermark_cols-1),d+b.watermark_y+b.watermark_height*b.watermark_rows+b.watermark_y_space*(b.watermark_rows-1)),I(b.watermark_color_size)),p=0;p<b.watermark_rows;p++)for(var f=n?d+b.watermark_y+(b.watermark_y_space+b.watermark_height)*p:b.watermark_y+(i-o)/2+(b.watermark_y_space+b.watermark_height)*p,y=0;y<b.watermark_cols;y++){var u=n?l+b.watermark_x+(w-a)/2+(b.watermark_width+b.watermark_x_space)*y:b.watermark_x+(w-a)/2+(b.watermark_width+b.watermark_x_space)*y,g=document.createElement("div"),v=document.createTextNode(b.watermark_txt),v=(g.appendChild(v),g.id=b.watermark_prefix+p+y,b.watermark_scale_random?Math.random()+1:b.watermark_scale),x=c[Math.floor(p+Math.random()*b.watermark_color_size)%b.watermark_color_size],v="rotate(-"+(b.watermark_angle_random?0==p?Math.trunc(360*Math.random()):Math.floor(Math.random()*p*360)%360:b.watermark_angle)+"deg) scale("+v+")";g.style.webkitTransform=v,g.style.MozTransform=v,g.style.msTransform=v,g.style.OTransform=v,g.style.transform=v,g.style.visibility="",g.style.position="absolute",g.style.left=u+"px",g.style.top=f+"px",g.style.overflow="hidden",g.style.zIndex="9999999",g.style.opacity=b.watermark_alpha,g.style.fontSize=b.watermark_fontsize,g.style.fontFamily=b.watermark_font,g.style.color=0<b.watermark_color_size?x:b.watermark_color,g.style.textAlign="center",g.style.width=b.watermark_width+"px",g.style.height=b.watermark_height+"px",g.style.display="block",g.style["-ms-user-select"]="none",k.appendChild(g)}(void 0===e.monitor?b:e).monitor&&M&&(z.observe(m,E),z.observe(document.getElementById(b.watermark_id).shadowRoot,E))},z=(e.init=function(e){o(r=e),window.addEventListener("onload",function(){o(e)}),window.addEventListener("resize",function(){o(e)})},e.load=function(e){o(r=e)},e.remove=function(){t=!0,function(){if(1===arguments.length&&"object"==typeof arguments[0]){var e,t=arguments[0]||{};for(e in t)t[e]&&b[e]&&t[e]===b[e]||!t[e]&&0!==t[e]||(b[e]=t[e])}var r=document.getElementById(b.watermark_id);r.parentNode.removeChild(r),z.disconnect()}()},new(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)(function(e){var t;r&&1===e.length||1===e.length&&1<=e[0].removedNodes.length?o(r):(e=document.getElementById(b.watermark_parent_node))&&(t=getComputedStyle(e).getPropertyValue("width"),e=getComputedStyle(e).getPropertyValue("height"),t===m.width&&e===m.height||(m.width=t,m.height=e,o(r)))})),E={childList:!0,attributes:!0,subtree:!0,attributeFilter:["style"],attributeOldValue:!0},m={width:0,height:0},I=function(e){for(var t=[],r=0;r<e;r++)t.push(function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}());return t};return e});